!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.openai_image=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/widget.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/widget.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";n.d(o,{default:()=>a});var e=n("ckeditor5/src/core.js");class t extends e.Command{execute(){const e=this.editor;this._createImageModal(e)}_createImageModal(e){const t=window.prompt("Enter your image prompt for OpenAI:");t&&(this._showLoadingIndicator(!0),fetch(`/openai-image/api/image/create?prompt=${t}&size=1024x1024&response_format=b64_json`,{method:"GET"}).then((e=>e.json())).then((n=>{if(this._showLoadingIndicator(!1),n.error)return console.error(n.error),void alert("Image generation failed with the following error: \n\n"+n.error);n&&n.length?this._showImageSelectionUI(e,n,t):console.error("No images returned from the API")})).catch((e=>{console.error("Error:",e)})))}_showImageSelectionUI(e,t,n){this._showLoadingIndicator(!1);const o=document.createElement("div");o.style.position="absolute",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.backgroundColor="#fff",o.style.padding="20px",o.style.border="1px solid #ccc",o.style.zIndex="1000",o.style.maxHeight="400px",o.style.overflowY="auto";const r=document.createElement("h3");r.innerText="Select an Image",o.appendChild(r);t.forEach((t=>{const r=document.createElement("img");r.src="data:image/png;base64,"+t.b64_json,r.style.width="100px",r.style.height="100px",r.style.margin="10px",r.style.cursor="pointer",r.addEventListener("click",(()=>{return r=t.b64_json,void fetch("/openai-image/api/image/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:r,filename:n})}).then((e=>e.json())).then((t=>{if(t.error)return console.error(t.error),void alert("Image saving failed with the following error: \n\n"+t.error);const r=t.url;e.model.change((t=>{const o=t.createElement("imageBlock",{src:r,alt:n});e.model.insertContent(o,e.model.document.selection)})),document.body.removeChild(o)})).catch((e=>{console.error("Error:",e),alert("There was an error saving your image.")}));var r})),o.appendChild(r)})),document.body.appendChild(o)}_showLoadingIndicator(e){let t=document.getElementById("loading-indicator");t||(t=document.createElement("div"),t.id="loading-indicator",t.innerText="Loading images...",t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="#fff",t.style.padding="20px",t.style.border="1px solid #ccc",t.style.zIndex="1000",t.style.maxHeight="400px",t.style.overflowY="auto",document.body.appendChild(t)),t.style.display=e?"block":"none"}}var r=n("ckeditor5/src/widget.js");class i extends e.Plugin{static get requires(){return[r.Widget]}init(){console.log("OpenAIImageGeneratorEditing#init() got called"),this.editor.commands.add("generateOpenaiImage",new t(this.editor))}}var s=n("ckeditor5/src/ui.js");class l extends e.Plugin{init(){const e=this.editor;e.ui.componentFactory.add("openai_image",(t=>{const n=new s.ButtonView(t);return n.set({label:e.t("OpenAI Image Generator"),icon:'<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"\n "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg version="1.0" xmlns="http://www.w3.org/2000/svg"\n width="20.000000pt" height="20.000000pt" viewBox="0 0 512.000000 512.000000"\n preserveAspectRatio="xMidYMid meet">\n\n<g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"\nfill="#000000" stroke="none">\n<path d="M3026 4869 c-62 -15 -153 -68 -197 -116 -22 -24 -55 -74 -72 -111\nl-32 -67 -3 -405 -3 -405 -197 -1 c-279 -2 -508 -36 -781 -115 -195 -57 -535\n-201 -583 -248 -24 -23 -121 -227 -166 -350 l-18 -46 -231 -5 -232 -5 -29 -28\nc-19 -18 -37 -56 -57 -116 l-28 -89 -123 -4 -124 -3 -32 -33 c-28 -28 -33 -39\n-33 -82 0 -43 5 -54 33 -82 l32 -33 190 0 189 0 28 28 c20 18 38 56 58 117\nl29 90 124 0 124 0 -7 -27 c-41 -160 -85 -436 -85 -536 0 -29 -4 -57 -8 -64\n-5 -9 -74 -13 -245 -15 l-237 -3 -32 -33 c-28 -28 -33 -39 -33 -82 0 -43 5\n-54 33 -82 l32 -33 237 -3 c171 -2 240 -6 245 -15 4 -7 8 -35 8 -64 0 -100 44\n-376 85 -535 l7 -28 -124 0 -124 0 -29 90 c-20 61 -38 99 -58 117 l-28 28\n-189 0 -190 0 -32 -33 c-28 -28 -33 -39 -33 -82 0 -43 5 -54 33 -82 l32 -33\n124 -3 123 -4 28 -89 c20 -60 38 -98 57 -116 l29 -28 232 -5 231 -5 18 -46\nc45 -123 142 -327 166 -350 49 -48 390 -192 599 -253 274 -79 501 -110 808\n-110 308 0 519 30 797 110 213 62 552 205 599 252 27 27 81 139 149 307 l37\n90 231 5 231 5 29 28 c19 18 37 56 57 116 l28 89 123 4 124 3 32 33 c28 28 33\n39 33 82 0 43 -5 54 -33 82 l-32 33 -190 0 -189 0 -28 -28 c-20 -18 -38 -56\n-58 -117 l-29 -90 -124 0 c-124 0 -124 0 -119 23 44 198 58 271 71 372 9 65\n16 142 16 170 0 27 4 55 8 62 5 9 74 13 245 15 l237 3 32 33 c28 28 33 39 33\n82 0 43 -5 54 -33 82 l-32 33 -237 3 c-171 2 -240 6 -245 15 -4 7 -8 33 -8 59\n0 109 -35 320 -97 585 l-5 21 259 4 259 3 76 37 c91 45 147 103 191 196 l32\n67 0 736 0 735 -37 76 c-45 91 -103 147 -196 191 l-67 32 -835 2 c-483 1 -851\n-3 -874 -8z m818 -508 c26 -27 31 -39 31 -81 0 -43 -5 -54 -33 -82 -28 -28\n-39 -33 -82 -33 -43 0 -54 5 -82 33 -28 28 -33 39 -33 81 0 52 25 92 70 112\n37 16 96 3 129 -30z m397 -78 c20 -20 72 -146 194 -468 184 -483 183 -481 125\n-540 l-30 -30 -650 0 -650 0 -32 33 c-28 28 -33 39 -33 80 1 42 17 75 164 332\n90 157 175 297 189 312 55 59 112 49 217 -38 43 -36 81 -61 85 -57 4 4 61 89\n127 188 148 222 154 228 227 220 26 -2 48 -13 67 -32z m-1534 -761 c8 -5 12\n-71 15 -212 l3 -205 32 -67 c44 -93 100 -151 191 -196 l76 -37 473 -3 c260 -2\n473 -5 473 -7 0 -2 16 -66 35 -142 61 -239 78 -385 78 -653 0 -191 -4 -261\n-21 -375 -26 -165 -77 -372 -125 -505 -42 -115 -136 -331 -151 -346 -15 -16\n-222 -106 -343 -150 -138 -50 -337 -100 -504 -125 -191 -30 -542 -32 -724 -5\n-174 25 -331 62 -484 112 -132 44 -375 147 -397 168 -35 33 -167 374 -214 549\n-159 601 -106 1197 158 1792 l49 110 69 34 c296 144 640 236 989 264 83 7 310\n6 322 -1z"/>\n<path d="M2420 3273 c-283 -30 -551 -161 -761 -372 -186 -185 -300 -394 -355\n-651 -26 -119 -26 -381 0 -500 55 -257 169 -466 355 -651 185 -186 394 -300\n651 -355 119 -26 381 -26 500 0 259 56 462 167 651 355 186 185 300 394 355\n651 26 120 26 372 0 495 -23 109 -66 236 -112 327 l-34 67 -332 3 c-315 3\n-336 5 -392 26 -240 89 -386 297 -386 549 l0 63 -52 -2 c-29 0 -69 -3 -88 -5z\nm-59 -750 c21 -21 67 -138 194 -488 183 -505 182 -502 125 -560 -26 -25 -38\n-30 -80 -30 -61 0 -97 31 -124 105 l-18 50 -178 0 -178 0 -18 -50 c-27 -74\n-63 -105 -124 -105 -42 0 -54 5 -80 30 -58 58 -59 55 125 560 162 448 183 495\n230 516 36 16 96 3 126 -28z m803 -82 l31 -31 0 -450 0 -450 -33 -32 c-28 -28\n-39 -33 -82 -33 -43 0 -54 5 -82 33 l-33 32 0 449 0 449 25 27 c33 36 57 46\n104 41 27 -3 49 -14 70 -35z"/>\n<path d="M2235 1968 c-22 -62 -41 -116 -43 -120 -2 -4 37 -8 87 -8 l90 0 -42\n120 c-23 66 -44 120 -47 120 -3 0 -23 -50 -45 -112z"/>\n</g>\n</svg>\n',tooltip:!0}),this.listenTo(n,"execute",(()=>e.execute("generateOpenaiImage"))),n}))}}class c extends e.Plugin{static get requires(){return[i,l]}}const a={OpenAIImageGenerator:c}})(),o=o.default})()));